---
import projectContext from 'virtual:pf/project-context'
import reciviData from 'virtual:recivi/data'

import type { BaseProps } from '../component_props/base'
import Anchor from './Anchor.astro'
import Comms from './Comms.astro'

type Props = BaseProps
const { class: className, ...attrs } = Astro.props

// Unlike `Header.astro`, this must link to the full URL, not just the path.
const { site, base } = projectContext
const href = site ? new URL(base, site).href : undefined
---

<header class:list={['pf-letterhead', className]} {...attrs}>
  <h1>
    {
      href ? (
        <Anchor class="home" url={{ dest: href, label: 'Home' }}>
          {reciviData.bio.name}
        </Anchor>
      ) : (
        reciviData.bio.name
      )
    }
  </h1>
  {reciviData.bio.summary ? <p>{reciviData.bio.summary}</p> : undefined}
  <Comms filterTag="resume_pdf" includeWeb={true} />
</header>

<style>
  @layer pf.components {
    .pf-letterhead {
      display: flex;
      flex-direction: column;
      gap: var(--pf-margin-block);
      margin-block-end: var(--pf-margin-block);
      text-align: center;

      & > * {
        /* Use `gap` and prevent child elements from combining margins. */
        margin-block: 0;
      }

      .home {
        font-weight: 700;
      }
    }
  }
</style>
